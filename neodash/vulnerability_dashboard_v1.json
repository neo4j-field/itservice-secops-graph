{
  "title": "DevSecOps & Vulnerability Management",
  "version": "2.4",
  "settings": {
    "pagenumber": 1,
    "editable": true,
    "fullscreenEnabled": false,
    "parameters": {
      "neodash_swName_Snapshot": "Zoolab",
      "neodash_snapshot_type": "SCA",
      "neodash_sw_component": "apache-mime4j-core",
      "neodash_softwarecomponent_component": "commons-io",
      "neodash_softwarecomponent_component_display": "commons-io",
      "neodash_another_variable ": "Zoolab",
      "neodash_selected_app": "Voyatouch",
      "neodash_selected_application": "Namfix"
    },
    "theme": "light"
  },
  "pages": [
    {
      "title": "Overview",
      "reports": [
        {
          "id": "8fec8afb-fb44-4f96-9619-7d341c4568e6",
          "title": "Number of Applications",
          "query": "MATCH (sw:Software) RETURN count(sw) AS nr_software_installed\n\n\n\n",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 0,
          "type": "value",
          "selection": {},
          "settings": {
            "textAlign": "center",
            "verticalAlign": "middle",
            "description": "Number of running applications for customer services",
            "fontSize": 96
          },
          "schema": []
        },
        {
          "id": "ce9256da-2a94-4dc2-898f-651a5512c326",
          "title": "Number of SCA analyses",
          "query": "MATCH p = (sn:Snapshot {type: 'SCA'})-[]-(sw:Software)\nRETURN count(p)",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 3,
          "type": "value",
          "selection": {},
          "settings": {
            "description": "Number of applications that have produced an SBOM and that have been scanned using Software Composition Analysis",
            "fontSize": 96,
            "textAlign": "center",
            "verticalAlign": "middle"
          },
          "schema": []
        },
        {
          "id": "5203777d-faf8-4727-9195-d109397d70d1",
          "title": "SCA adoption rate",
          "query": "MATCH (sw:Software)\nOPTIONAL MATCH (sn:Snapshot {type: 'SCA'})-[]-(sw)\nRETURN toFloat(count(sn)) / toFloat(count(sw)) * 100\n\n",
          "width": 11,
          "height": 3,
          "x": 8,
          "y": 3,
          "type": "gauge",
          "selection": {},
          "settings": {},
          "schema": []
        },
        {
          "id": "b014e9ec-6efd-4782-9893-1413865d0551",
          "title": "DevSecOps analysis tooling",
          "query": "MATCH (vl:Vulnerability|Finding)\nRETURN DISTINCT (vl.source) as name\n\n\n\n",
          "width": 11,
          "height": 3,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "be810aea-d256-41f2-9813-bcf816c35544",
          "title": "Number of SAST analyses",
          "query": "MATCH p = (sn:Snapshot {type: 'SAST'})-[]-(sw:Software)\nRETURN count(p)\n\n",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 6,
          "type": "value",
          "selection": {},
          "settings": {
            "verticalAlign": "middle",
            "textAlign": "center",
            "fontSize": 96
          },
          "schema": []
        },
        {
          "id": "d450173e-2970-4171-bd78-18b87152e103",
          "title": "SAST adoption rate",
          "query": "\n\nMATCH (sw:Software)\nOPTIONAL MATCH (sn:Snapshot {type: 'SAST'})-[]-(sw)\nRETURN toFloat(count(sn)) / toFloat(count(sw)) * 100\n\n\n",
          "width": 11,
          "height": 3,
          "x": 8,
          "y": 6,
          "type": "gauge",
          "selection": {},
          "settings": {},
          "schema": []
        }
      ]
    },
    {
      "title": "SCA overview",
      "reports": [
        {
          "id": "c9850ef1-7cf1-4de0-8a7c-9f55d944c313",
          "title": "Critical Open Source vulnerabilities",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH critical_p = (vl:Vulnerability)-[]-(sc) WHERE vl.severity = \"critical\"\nRETURN sw.swName as Application, count(critical_p) as Vulnerabilities\nORDER BY Vulnerabilities DESC",
          "width": 10,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Application",
                "value": "SoftwareName",
                "customization": "set variable",
                "customizationValue": "selected_app"
              }
            ],
            "columnWidths": "[0.2,0.8]"
          },
          "schema": []
        },
        {
          "id": "bbbbc9f1-7079-46d7-a32c-b0f0189e25a5",
          "title": "SCA vulnerability severities",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH vuln_p = (vl:Vulnerability)-[]-(sc)\nRETURN vl.severity AS Severity, count(vuln_p) as Vulnerabilities\n\n\n",
          "width": 8,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "bar",
          "selection": {
            "index": "Severity",
            "value": "Vulnerabilities",
            "key": "Severity"
          },
          "settings": {
            "valueScale": "linear",
            "barValues": true,
            "positionLabel": "off",
            "marginBottom": 50,
            "showOptionalSelections": true,
            "layout": "vertical",
            "groupMode": "stacked",
            "colors": "accent",
            "customDimensions": false,
            "innerPadding": 5
          },
          "schema": []
        },
        {
          "id": "7f8c872d-db0c-4a72-aa99-fc688588980f",
          "title": "Software Structure and Vulnerabilities associated",
          "query": "MATCH p=(sw:Software {swName: $neodash_selected_app})<-[]-(:Snapshot)<-[]-(:SoftwareComponent)<-[]-(vl:Vulnerability) WHERE vl.severity = \"critical\"\nRETURN p\n\n",
          "width": 22,
          "height": 9,
          "x": 0,
          "y": 9,
          "type": "graph",
          "selection": {
            "Software": "(label)",
            "Snapshot": "(label)",
            "SoftwareComponent": "(label)",
            "Vulnerability": "title"
          },
          "settings": {
            "layout": "force-directed"
          },
          "schema": [
            [
              "Software",
              "swName",
              "swOwner",
              "swVersion",
              "swFirstSeen",
              "swVendor",
              "swLastUpdated"
            ],
            [
              "Snapshot",
              "date",
              "ref",
              "source",
              "type"
            ],
            [
              "SoftwareComponent",
              "component",
              "purl",
              "version"
            ],
            [
              "Vulnerability",
              "severity",
              "fixed_version",
              "vulnerability_id",
              "link",
              "source",
              "published",
              "title",
              "cvss",
              "status"
            ]
          ]
        },
        {
          "id": "f296c3ad-e0bc-47ab-8be1-65d9f1e949cc",
          "title": "Relevant Open Source Components",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software {swName: $neodash_selected_app})\nMATCH critical_p = (vl:Vulnerability)-[]-(sc) WHERE vl.severity = \"critical\"\nRETURN sc.component as component, sc.version as version, count(critical_p) as Vulnerabilities\nORDER BY Vulnerabilities DESC\n\n",
          "width": 12,
          "height": 4,
          "x": 10,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "ae977e30-af76-4509-bb0b-ed1c81010fe3",
          "title": "CVSS distribution (rounded)",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH vuln_p = (vl:Vulnerability)-[]-(sc)\nRETURN toInteger(vl.cvss) AS cvss, count(DISTINCT vuln_p) as Vulnerabilities\nORDER BY cvss\n\n\n",
          "width": 9,
          "height": 5,
          "x": 8,
          "y": 0,
          "type": "bar",
          "selection": {
            "index": "cvss",
            "value": "Vulnerabilities",
            "key": "(none)"
          },
          "settings": {
            "valueScale": "linear",
            "displayYGridLines": true,
            "displayYAxis": true
          },
          "schema": []
        },
        {
          "id": "b4566751-c749-42fd-9b27-25223b5c016a",
          "title": "Vulnerability Status",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH count_p = (vl:Vulnerability)-[]-(sc)\nRETURN DISTINCT vl.status as Status, count(DISTINCT count_p) as Vulnerabilities\n\n\n",
          "width": 5,
          "height": 5,
          "x": 17,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {}
        }
      ]
    },
    {
      "title": "SCA drill down",
      "reports": [
        {
          "id": "06075f52-0723-439b-848e-7c38861c8136",
          "title": "Installed Software",
          "query": "MATCH(sw:Software)<-[:SNAPSHOT_OF]-(:Snapshot)\nRETURN sw.swName AS SoftwareName;\n\n\n",
          "width": 11,
          "height": 6,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "SoftwareName",
                "value": "SoftwareName",
                "customization": "set variable",
                "customizationValue": "swName_Snapshot"
              },
              {
                "condition": "Click",
                "field": "SoftwareName",
                "value": "",
                "customization": "set variable",
                "customizationValue": "another_variable "
              }
            ]
          }
        },
        {
          "id": "8dc2252a-cd53-40f0-990f-9377e5bacea4",
          "title": "Vulnerable Open Source Components",
          "query": "MATCH (sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot {type: 'SCA'})<-[:IDENTIFIED_IN]-(sc:SoftwareComponent)\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN DISTINCT sc.component AS Component, sc.version AS Version",
          "width": 12,
          "height": 6,
          "x": 11,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Component",
                "value": "Component",
                "customization": "set variable",
                "customizationValue": "sw_component"
              }
            ],
            "columnWidths": "[0.5,0.2,0.2]"
          }
        },
        {
          "id": "544acdb1-e1a4-422f-92be-6c95cad2e01b",
          "title": "Known Vulnerabilities for $neodash_sw_component",
          "query": "OPTIONAL MATCH (sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot {type: $neodash_snapshot_type})<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_sw_component})-[:VULNERABILITY_OF]-(vu:Vulnerability)\nRETURN vu.vulnerability_id as cve_id, vu.severity as severity, vu.status as status, vu.fixed_version as fixed_version, vu.link as more_info;\n\n\n\n",
          "width": 23,
          "height": 4,
          "x": 0,
          "y": 6,
          "type": "table",
          "selection": {},
          "settings": {
            "columnWidths": "[0.2,0.1,0.1,0.1,0.5]"
          }
        },
        {
          "id": "5e4e9653-7408-4d8b-9c27-5a1eaa545670",
          "title": "Services Affected by Vulerabilities",
          "query": "MATCH (cu:Customer)<-[:CONSUMED_BY]-(sv:Service)<-[:DELIVERS]-(sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})<-[:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN  DISTINCT sv.serviceName as Service, sv.serviceOwner as `Service Owner`, cu.customerName AS Customer, cu.customerImportance AS `Customer Importance`\nORDER BY `Customer Importance` DESC;\n\n",
          "width": 23,
          "height": 6,
          "x": 0,
          "y": 10,
          "type": "table",
          "selection": {},
          "settings": {
            "styleRules": [
              {
                "field": "Status",
                "condition": "=",
                "value": "fixed",
                "customization": "cell color",
                "customizationValue": "#5AEF5A"
              },
              {
                "field": "Status",
                "condition": "!=",
                "value": "fixed",
                "customization": "row color",
                "customizationValue": "orange"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "9",
                "customization": "cell color",
                "customizationValue": "red"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "7",
                "customization": "cell color",
                "customizationValue": "orange"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "4",
                "customization": "cell color",
                "customizationValue": "lightblue"
              }
            ]
          }
        }
      ]
    },
    {
      "title": "SCA search",
      "reports": [
        {
          "id": "d2fb639c-d395-4ce0-a129-7b2374feb88a",
          "title": "Search for SW Component",
          "query": "MATCH (n:`SoftwareComponent`) \nWHERE toLower(toString(n.`component`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`component` as value,  n.`component` as display ORDER BY size(toString(value)) ASC LIMIT 5",
          "width": 8,
          "height": 4,
          "x": 0,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Node Property",
            "entityType": "SoftwareComponent",
            "propertyType": "component",
            "propertyTypeDisplay": "component",
            "parameterName": "neodash_softwarecomponent_component"
          },
          "schema": []
        },
        {
          "id": "a1761ad8-bb5b-405e-b0ec-6b6b69195550",
          "title": "found vulnerable components",
          "query": "\nMATCH (sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN DISTINCT sc.component AS Component, sc.version AS Version, sc.purl AS PURL;\n\n",
          "width": 14,
          "height": 4,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "25e18614-1ea7-481a-8d4a-098f0ae02aca",
          "title": "Found vulnerable Application-Services",
          "query": "MATCH (sv:Service)\nMATCH (sv)-[]-(sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN  DISTINCT sv.serviceName as Service, sw.swName as Application, sv.serviceOwner as `Service Owner`\nORDER BY sw.swName\n\n\n\n",
          "width": 22,
          "height": 5,
          "x": 0,
          "y": 4,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "92ad2d44-e67b-4109-8352-cd37cff93d10",
          "title": "Customers affected in case of critical Vulnerabilities",
          "query": "MATCH (cu:Customer)<-[:CONSUMED_BY]-(sv:Service)<-[:DELIVERS]-(sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})<-[:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN  DISTINCT sv.serviceName as Service, sv.serviceOwner as `Service Owner`, cu.customerName AS Customer, cu.customerImportance AS `Customer Importance`\nORDER BY `Customer Importance` DESC;\n\n\n",
          "width": 22,
          "height": 4,
          "x": 0,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "styleRules": [
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "9",
                "customization": "cell color",
                "customizationValue": "#FA0505"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "7",
                "customization": "cell color",
                "customizationValue": "orange"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "4",
                "customization": "cell color",
                "customizationValue": "lightblue"
              }
            ],
            "columnWidths": "[0.3,0.3,0.3,0.1]"
          }
        }
      ]
    },
    {
      "title": "SAST overview",
      "reports": [
        {
          "id": "6d5ffa12-65c1-4f59-95d2-275a7928ea21",
          "title": "SAST Findings by severity",
          "query": "MATCH (sn:Snapshot)-[]-(sw:Software)\nMATCH critical_p = (fn:Finding)-[]-(sn)\nRETURN sw.swName as Application, fn.severity as severity, count(critical_p) as Findings\nORDER BY Findings DESC",
          "width": 10,
          "height": 4,
          "x": 0,
          "y": 0,
          "type": "bar",
          "selection": {
            "index": "severity",
            "value": "Findings",
            "key": "(none)"
          },
          "settings": {},
          "schema": []
        },
        {
          "id": "803668ef-1ac4-4449-9034-2ce0a1f0a0bd",
          "title": "High SAST findings",
          "query": "MATCH (sn:Snapshot)-[]-(sw:Software)\nMATCH critical_p = (fn:Finding)-[]-(sn) WHERE fn.severity IN [\"high\", \"critical\"]\nRETURN sw.swName as Application, count(DISTINCT critical_p) as Findings\nORDER BY Findings DESC",
          "width": 13,
          "height": 4,
          "x": 10,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Application",
                "value": "Application",
                "customization": "set variable",
                "customizationValue": "selected_application"
              }
            ]
          }
        },
        {
          "id": "8415ebf0-658e-4b65-a5c1-fe78f3c2d4ab",
          "title": "High SAST findings for the selected application",
          "query": "\nMATCH (sn:Snapshot)-[]-(sw:Software {swName: $neodash_selected_application})\nMATCH p = (fn:Finding)-[]-(sn) WHERE fn.severity IN [\"critical\", \"high\"]\nRETURN fn.title as Title, fn.severity as Severity, fn.link as link, count(DISTINCT p) as Findings\nORDER BY Findings DESC\n\n",
          "width": 23,
          "height": 5,
          "x": 0,
          "y": 4,
          "type": "table",
          "selection": {},
          "settings": {}
        }
      ]
    }
  ],
  "parameters": {},
  "extensions": {
    "active": true,
    "activeReducers": [],
    "advanced-charts": {
      "active": true
    },
    "styling": {
      "active": true
    },
    "actions": {
      "active": true
    }
  },
  "uuid": "b7f3d9c7-f067-4ae3-b7f2-e2f618946e04"
}